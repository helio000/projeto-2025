<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sala de Alunos</title>
<style>
    body { background: #222 url('fundoForm2.png') no-repeat center; background-size: cover; color: white; font-family: sans-serif; }
    .aluno { background: rgba(0,0,0,0.5); margin:10px; padding:10px; border-radius:5px; }
    button { margin-top:5px; cursor:pointer; }
</style>
</head>
<body>

<h3>Sala de Alunos</h3>
<button onclick="window.location.href='cadastro.html'">Voltar ao Cadastro</button>
<div id="lista-sala"></div>

<script>
document.addEventListener('DOMContentLoaded', async () => {
    const alunoLogado = JSON.parse(localStorage.getItem('alunoLogado'));
    if(!alunoLogado) {
        alert("FaÃ§a login primeiro!");
        window.location.href='login.html';
        return;
    }

    async function carregarAlunos(){
        try {
            const res = await fetch('http://localhost:3100/alunos');
            const alunos = await res.json();
            const div = document.getElementById('lista-sala');
            div.innerHTML = '';
            alunos.forEach(a=>{
                const bloco = document.createElement('div');
                bloco.classList.add('aluno');
                bloco.innerHTML = `<p>${a.nome} - ${a.email} - ${a.telefone}</p>
                                   <button data-id="${a.id}">Remover</button>`;
                bloco.querySelector('button').addEventListener('click', async ()=>{
                    await fetch(`http://localhost:3100/alunos/${a.id}`, {method:'DELETE'});
                    carregarAlunos();
                });
                div.appendChild(bloco);
            });
        } catch(err){
            document.getElementById('lista-sala').textContent = 'Erro ao carregar alunos';
        }
    }

    carregarAlunos();
});
</script>
</body>
</html>
